<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- App Metadata -->
    <meta name="app-name" content="å¤¢æ—¥è¨˜AIè§£æ">
    <meta name="app-version" content="1.0.0">
    <meta name="app-created-by" content="Claude Sonnet 4">
    <meta name="app-created-date" content="2025-06-20">
    <meta name="app-model-id" content="claude-sonnet-4-20250514">
    <meta name="app-category" content="AIãƒ»åˆ†æ">
    <meta name="app-tags" content="å¤¢åˆ†æ,å¿ƒç†åˆ†æ,AIè§£æ,æ—¥è¨˜,æ·±å±¤å¿ƒç†,æ„Ÿæƒ…åˆ†æ">
    <meta name="app-target-users" content="12000">
    <meta name="app-last-modified" content="2025-06-20">
    <meta name="app-description" content="AIãŒå¤¢ã®å†…å®¹ã‚’åˆ†æã—ã¦å¿ƒç†çŠ¶æ…‹ã‚„è±¡å¾´çš„æ„å‘³ã‚’è§£é‡ˆã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³">
    <title>å¤¢æ—¥è¨˜AIè§£æ</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #2c1810 0%, #1a0f3d 25%, #0d2f5e 50%, #1a4d2e 75%, #3d1a1a 100%);
            background-size: 400% 400%;
            animation: dreamShift 20s ease-in-out infinite;
            color: white;
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
        }

        @keyframes dreamShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 20px;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(138, 43, 226, 0.3);
        }

        h1 {
            margin: 0;
            font-size: 3rem;
            background: linear-gradient(45deg, #9370db, #4b0082, #663399, #8a2be2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(147, 112, 219, 0.5);
            animation: titleGlow 3s ease-in-out infinite;
        }

        @keyframes titleGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .dream-input {
            background: rgba(0, 0, 0, 0.8);
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(138, 43, 226, 0.3);
        }

        .analysis-panel {
            background: rgba(0, 0, 0, 0.8);
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(75, 0, 130, 0.3);
        }

        h2 {
            color: #9370db;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(138, 43, 226, 0.5);
            border-radius: 15px;
            color: white;
            font-size: 16px;
            line-height: 1.6;
            resize: vertical;
            backdrop-filter: blur(10px);
        }

        textarea::placeholder {
            color: rgba(255, 255, 255, 0.6);
            font-style: italic;
        }

        .input-helpers {
            display: flex;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .helper-tag {
            padding: 8px 15px;
            background: rgba(138, 43, 226, 0.3);
            border: 1px solid #9370db;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .helper-tag:hover {
            background: rgba(138, 43, 226, 0.6);
            transform: scale(1.05);
        }

        button {
            padding: 15px 30px;
            background: linear-gradient(45deg, #9370db, #4b0082);
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(147, 112, 219, 0.4);
        }

        .analysis-result {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            border-left: 4px solid #9370db;
            backdrop-filter: blur(10px);
        }

        .symbol-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .symbol-card {
            background: rgba(138, 43, 226, 0.2);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(138, 43, 226, 0.4);
            text-align: center;
            transition: all 0.3s ease;
        }

        .symbol-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(138, 43, 226, 0.3);
        }

        .symbol-emoji {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        .symbol-name {
            font-weight: bold;
            color: #dda0dd;
            margin-bottom: 5px;
        }

        .symbol-meaning {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        .mood-indicator {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
        }

        .mood-item {
            text-align: center;
            flex: 1;
        }

        .mood-emoji {
            font-size: 2rem;
            display: block;
            margin-bottom: 5px;
        }

        .mood-label {
            font-size: 12px;
            color: #dda0dd;
        }

        .mood-value {
            font-weight: bold;
            margin-top: 5px;
        }

        .dream-history {
            grid-column: 1 / -1;
            background: rgba(0, 0, 0, 0.8);
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(138, 43, 226, 0.3);
        }

        .history-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 12px;
            margin: 10px 0;
            border-left: 4px solid #9370db;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .history-item:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateX(5px);
        }

        .history-date {
            font-size: 12px;
            color: #dda0dd;
            margin-bottom: 5px;
        }

        .history-preview {
            font-size: 14px;
            line-height: 1.4;
        }

        .keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }

        .keyword {
            padding: 4px 12px;
            background: rgba(147, 112, 219, 0.3);
            border-radius: 15px;
            font-size: 12px;
            color: #dda0dd;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #9370db;
            font-style: italic;
        }

        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: rgba(138, 43, 226, 0.2);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(138, 43, 226, 0.4);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #dda0dd;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .input-helpers {
                justify-content: center;
            }
            
            .mood-indicator {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŒ™ å¤¢æ—¥è¨˜AIè§£æ</h1>
            <p>ã‚ãªãŸã®å¤¢ã‚’è¨˜éŒ²ã—ã€AIãŒè±¡å¾´ã‚„æ„å‘³ã‚’åˆ†æã™ã‚‹</p>
        </div>

        <div class="main-content">
            <div class="dream-input">
                <h2>ğŸ’­ å¤¢ã®è¨˜éŒ²</h2>
                
                <textarea id="dreamText" placeholder="ä»Šæœè¦‹ãŸå¤¢ã‚’è©³ã—ãæ•™ãˆã¦ãã ã•ã„...&#10;&#10;ä¾‹:&#10;ãƒ»ã©ã‚“ãªå ´æ‰€ã«ã„ã¾ã—ãŸã‹ï¼Ÿ&#10;ãƒ»èª°ãŒç™»å ´ã—ã¾ã—ãŸã‹ï¼Ÿ&#10;ãƒ»ã©ã‚“ãªæ„Ÿæƒ…ã‚’æ„Ÿã˜ã¾ã—ãŸã‹ï¼Ÿ&#10;ãƒ»å°è±¡çš„ãªã‚·ãƒ¼ãƒ³ã‚„è‰²ã¯ã‚ã‚Šã¾ã—ãŸã‹ï¼Ÿ&#10;ãƒ»å¤¢ã®ä¸­ã§ä½•ã‚’ã—ã¦ã„ã¾ã—ãŸã‹ï¼Ÿ"></textarea>
                
                <div class="input-helpers">
                    <span class="helper-tag" onclick="addToText('ç©ºã‚’é£›ã‚“ã§ã„ã‚‹')">ğŸ•Šï¸ é£›è¡Œ</span>
                    <span class="helper-tag" onclick="addToText('è¿½ã„ã‹ã‘ã‚‰ã‚Œã‚‹')">ğŸƒ è¿½è·¡</span>
                    <span class="helper-tag" onclick="addToText('æ°´ã®ä¸­ã«ã„ã‚‹')">ğŸŒŠ æ°´</span>
                    <span class="helper-tag" onclick="addToText('é«˜ã„ã¨ã“ã‚ã‹ã‚‰è½ã¡ã‚‹')">â¬‡ï¸ è½ä¸‹</span>
                    <span class="helper-tag" onclick="addToText('çŸ¥ã‚‰ãªã„äºº')">ğŸ‘¤ æœªçŸ¥ã®äºº</span>
                    <span class="helper-tag" onclick="addToText('å‹•ç‰©ãŒç¾ã‚Œã‚‹')">ğŸº å‹•ç‰©</span>
                </div>
                
                <button onclick="analyzeDream()">ğŸ”® å¤¢ã‚’è§£æã™ã‚‹</button>
                <button onclick="saveDream()">ğŸ’¾ å¤¢ã‚’ä¿å­˜</button>
                <button onclick="clearInput()">ğŸ—‘ï¸ ã‚¯ãƒªã‚¢</button>
            </div>

            <div class="analysis-panel">
                <h2>ğŸ§  AIåˆ†æçµæœ</h2>
                
                <div id="analysisResult">
                    <div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.6);">
                        <span style="font-size: 3rem;">ğŸŒ™</span>
                        <p>å¤¢ã®å†…å®¹ã‚’å…¥åŠ›ã—ã¦åˆ†æãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="dream-history">
            <h2>ğŸ“š å¤¢ã®å±¥æ­´</h2>
            
            <div class="stats-panel">
                <div class="stat-card">
                    <div class="stat-value" id="totalDreams">0</div>
                    <div class="stat-label">è¨˜éŒ²ã—ãŸå¤¢</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="commonMood">ğŸ˜´</div>
                    <div class="stat-label">ä¸€èˆ¬çš„ãªæ°—åˆ†</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgLength">0</div>
                    <div class="stat-label">å¹³å‡æ–‡å­—æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="streakDays">0</div>
                    <div class="stat-label">é€£ç¶šè¨˜éŒ²æ—¥æ•°</div>
                </div>
            </div>
            
            <div id="dreamHistoryList">
                <div style="text-align: center; padding: 20px; color: rgba(255,255,255,0.6);">
                    ã¾ã å¤¢ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚æœ€åˆã®å¤¢ã‚’è¨˜éŒ²ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼
                </div>
            </div>
        </div>
    </div>

    <script>
        let dreamHistory = JSON.parse(localStorage.getItem('dreamHistory')) || [];
        
        // å¤¢ã®ã‚·ãƒ³ãƒœãƒ«è¾æ›¸
        const dreamSymbols = {
            'é£›': { emoji: 'ğŸ•Šï¸', name: 'é£›è¡Œ', meaning: 'è‡ªç”±ã¸ã®æ†§ã‚Œã€æŸç¸›ã‹ã‚‰ã®è§£æ”¾ã€ä¸Šæ˜‡å¿—å‘' },
            'æ°´': { emoji: 'ğŸŒŠ', name: 'æ°´', meaning: 'æ„Ÿæƒ…ã€ç„¡æ„è­˜ã€æµ„åŒ–ã€ç”Ÿå‘½åŠ›' },
            'ç«': { emoji: 'ğŸ”¥', name: 'ç«', meaning: 'æƒ…ç†±ã€æ€’ã‚Šã€å¤‰åŒ–ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼' },
            'å‹•ç‰©': { emoji: 'ğŸº', name: 'å‹•ç‰©', meaning: 'æœ¬èƒ½ã€é‡æ€§çš„ãªæ¬²æ±‚ã€å†…ãªã‚‹åŠ›' },
            'å®¶': { emoji: 'ğŸ ', name: 'å®¶', meaning: 'å®‰å…¨ã€å®¶æ—ã€è‡ªåˆ†è‡ªèº«ã®å†…é¢' },
            'è¿½': { emoji: 'ğŸƒ', name: 'è¿½è·¡', meaning: 'ææ€–ã€ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã€é€ƒé¿é¡˜æœ›' },
            'è½': { emoji: 'â¬‡ï¸', name: 'è½ä¸‹', meaning: 'ä¸å®‰ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®å–ªå¤±ã€å¤±æ•—ã¸ã®æã‚Œ' },
            'æ­»': { emoji: 'ğŸ’€', name: 'æ­»', meaning: 'å¤‰åŒ–ã€çµ‚ã‚ã‚Šã¨å§‹ã¾ã‚Šã€å†ç”Ÿ' },
            'é“': { emoji: 'ğŸ›¤ï¸', name: 'é“', meaning: 'äººç”Ÿã®é“ã®ã‚Šã€é¸æŠã€å°†æ¥ã¸ã®æ–¹å‘æ€§' },
            'è»Š': { emoji: 'ğŸš—', name: 'è»Š', meaning: 'ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã€äººç”Ÿã®é€²è·¯ã€è‡ªç«‹' },
            'æ©‹': { emoji: 'ğŸŒ‰', name: 'æ©‹', meaning: 'å¤‰åŒ–ã®æ™‚æœŸã€ã¤ãªãŒã‚Šã€éæ¸¡æœŸ' },
            'å±±': { emoji: 'â›°ï¸', name: 'å±±', meaning: 'ç›®æ¨™ã€å›°é›£ã€é”æˆã¸ã®é“ã®ã‚Š' },
            'æµ·': { emoji: 'ğŸŒŠ', name: 'æµ·', meaning: 'ç„¡æ„è­˜ã€æ„Ÿæƒ…ã®æ·±ã•ã€æœªçŸ¥ã¸ã®ææ€–' },
            'ç©º': { emoji: 'â˜ï¸', name: 'ç©º', meaning: 'ç„¡é™ã®å¯èƒ½æ€§ã€è‡ªç”±ã€ç²¾ç¥æ€§' },
            'èŠ±': { emoji: 'ğŸŒ¸', name: 'èŠ±', meaning: 'ç¾ã—ã•ã€æˆé•·ã€ç”Ÿå‘½åŠ›ã€æ‹æ„›' }
        };
        
        function addToText(text) {
            const textarea = document.getElementById('dreamText');
            const currentText = textarea.value;
            if (currentText) {
                textarea.value = currentText + 'ã€' + text;
            } else {
                textarea.value = text;
            }
        }
        
        function analyzeDream() {
            const dreamText = document.getElementById('dreamText').value.trim();
            
            if (!dreamText) {
                alert('å¤¢ã®å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
            document.getElementById('analysisResult').innerHTML = '<div class="loading">ğŸ”® AIãŒå¤¢ã‚’è§£æä¸­...<br>æ·±å±¤å¿ƒç†ã‚’èª­ã¿å–ã£ã¦ã„ã¾ã™...</div>';
            
            // æ“¬ä¼¼çš„ãªåˆ†æå‡¦ç†ï¼ˆå®Ÿéš›ã®AIåˆ†æã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼‰
            setTimeout(() => {
                const analysis = performDreamAnalysis(dreamText);
                displayAnalysis(analysis);
            }, 2000);
        }
        
        function performDreamAnalysis(dreamText) {
            const words = dreamText.toLowerCase();
            const detectedSymbols = [];
            const keywords = [];
            
            // ã‚·ãƒ³ãƒœãƒ«æ¤œå‡º
            for (const [key, symbol] of Object.entries(dreamSymbols)) {
                if (words.includes(key)) {
                    detectedSymbols.push(symbol);
                }
            }
            
            // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡º
            const commonKeywords = ['æ„Ÿæƒ…', 'ææ€–', 'å–œã³', 'ä¸å®‰', 'æ„›', 'å‹äºº', 'å®¶æ—', 'ä»•äº‹', 'å­¦æ ¡', 'è‰²', 'éŸ³', 'åŒ‚ã„'];
            commonKeywords.forEach(keyword => {
                if (words.includes(keyword)) {
                    keywords.push(keyword);
                }
            });
            
            // æ„Ÿæƒ…åˆ†æï¼ˆç°¡æ˜“ç‰ˆï¼‰
            const positiveWords = ['æ¥½ã—ã„', 'å¬‰ã—ã„', 'ç¾ã—ã„', 'å¹³å’Œ', 'å®‰å¿ƒ', 'å¹¸ã›', 'æ˜ã‚‹ã„'];
            const negativeWords = ['æ€–ã„', 'æ‚²ã—ã„', 'ä¸å®‰', 'æš—ã„', 'ç—›ã„', 'è¾›ã„', 'è‹¦ã—ã„'];
            
            let positiveScore = 0;
            let negativeScore = 0;
            
            positiveWords.forEach(word => {
                if (words.includes(word)) positiveScore++;
            });
            
            negativeWords.forEach(word => {
                if (words.includes(word)) negativeScore++;
            });
            
            // å¤¢ã®ã‚¿ã‚¤ãƒ—åˆ¤å®š
            let dreamType = 'æ—¥å¸¸çš„ãªå¤¢';
            if (words.includes('é£›') || words.includes('ç©º')) dreamType = 'é£›è¡Œã®å¤¢';
            else if (words.includes('è¿½') || words.includes('é€ƒã’')) dreamType = 'è¿½è·¡ã®å¤¢';
            else if (words.includes('æ°´') || words.includes('æµ·')) dreamType = 'æ°´ã®å¤¢';
            else if (words.includes('è½') || words.includes('é«˜ã„')) dreamType = 'è½ä¸‹ã®å¤¢';
            
            return {
                dreamType,
                symbols: detectedSymbols,
                keywords,
                mood: {
                    positive: positiveScore,
                    negative: negativeScore,
                    neutral: Math.max(0, 5 - positiveScore - negativeScore)
                },
                interpretation: generateInterpretation(dreamType, detectedSymbols, positiveScore, negativeScore),
                advice: generateAdvice(dreamType, positiveScore, negativeScore)
            };
        }
        
        function generateInterpretation(dreamType, symbols, positive, negative) {
            const interpretations = {
                'é£›è¡Œã®å¤¢': 'è‡ªç”±ã¸ã®å¼·ã„æ†§ã‚Œã¨ã€ç¾å®Ÿã®åˆ¶ç´„ã‹ã‚‰ã®è§£æ”¾é¡˜æœ›ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚å‰µé€ æ€§ã¨å¯èƒ½æ€§ã¸ã®é–‹æ”¾æ€§ã‚’ç¤ºå”†ã—ã¦ã„ã¾ã™ã€‚',
                'è¿½è·¡ã®å¤¢': 'ç¾å®Ÿç”Ÿæ´»ã§ã®ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚„ã‚¹ãƒˆãƒ¬ã‚¹ã‚’åæ˜ ã—ã¦ã„ã¾ã™ã€‚ä½•ã‹ã‹ã‚‰é€ƒã‚ŒãŸã„æ°—æŒã¡ã‚„ã€å¯¾å‡¦ã™ã¹ãå•é¡ŒãŒã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚',
                'æ°´ã®å¤¢': 'æ„Ÿæƒ…ã®æµã‚Œã‚„ç„¡æ„è­˜ã®å‹•ãã‚’è¡¨ç¾ã—ã¦ã„ã¾ã™ã€‚å¿ƒã®æµ„åŒ–ã‚„æ„Ÿæƒ…çš„ãªå¤‰åŒ–ã®æ™‚æœŸã«ã‚ã‚‹ã“ã¨ã‚’ç¤ºå”†ã—ã¦ã„ã¾ã™ã€‚',
                'è½ä¸‹ã®å¤¢': 'ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®å–ªå¤±ã¸ã®ä¸å®‰ã‚„ã€ç¾å®Ÿã§ã®ä¸å®‰å®šæ„Ÿã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚å¤‰åŒ–ã¸ã®æã‚Œã‚’ç¤ºã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚',
                'æ—¥å¸¸çš„ãªå¤¢': 'æ—¥å¸¸ç”Ÿæ´»ã®å‡¦ç†ã¨æ•´ç†ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚å¿ƒã®ãƒãƒ©ãƒ³ã‚¹ãŒä¿ãŸã‚Œã¦ã„ã‚‹çŠ¶æ…‹ã‚’ç¤ºå”†ã—ã¦ã„ã¾ã™ã€‚'
            };
            
            let base = interpretations[dreamType] || interpretations['æ—¥å¸¸çš„ãªå¤¢'];
            
            if (positive > negative) {
                base += ' å…¨ä½“çš„ã«ãƒã‚¸ãƒ†ã‚£ãƒ–ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ã«æº€ã¡ã¦ãŠã‚Šã€å¿ƒã®çŠ¶æ…‹ã¯è‰¯å¥½ã§ã™ã€‚';
            } else if (negative > positive) {
                base += ' ä¸€æ™‚çš„ãªã‚¹ãƒˆãƒ¬ã‚¹ã‚„ä¸å®‰ã‚’æŠ±ãˆã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã‚»ãƒ«ãƒ•ã‚±ã‚¢ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†ã€‚';
            } else {
                base += ' æ„Ÿæƒ…ã®ãƒãƒ©ãƒ³ã‚¹ãŒå–ã‚Œã¦ãŠã‚Šã€å®‰å®šã—ãŸå¿ƒç†çŠ¶æ…‹ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚';
            }
            
            return base;
        }
        
        function generateAdvice(dreamType, positive, negative) {
            const advices = {
                'é£›è¡Œã®å¤¢': 'å‰µé€ çš„ãªæ´»å‹•ã«æ™‚é–“ã‚’å‰²ã„ã¦ã¿ã¦ãã ã•ã„ã€‚æ–°ã—ã„æŒ‘æˆ¦ãŒã‚ãªãŸã‚’å¾…ã£ã¦ã„ã¾ã™ã€‚',
                'è¿½è·¡ã®å¤¢': 'ã‚¹ãƒˆãƒ¬ã‚¹è§£æ¶ˆã®æ™‚é–“ã‚’ä½œã‚Šã€å•é¡Œã«æ­£é¢ã‹ã‚‰å‘ãåˆã†å‹‡æ°—ã‚’æŒã£ã¦ãã ã•ã„ã€‚',
                'æ°´ã®å¤¢': 'æ„Ÿæƒ…ã‚’å¤§åˆ‡ã«ã—ã€ç›´æ„Ÿã«å¾“ã£ã¦è¡Œå‹•ã™ã‚‹ã“ã¨ãŒå‰ã¨ãªã‚‹ã§ã—ã‚‡ã†ã€‚',
                'è½ä¸‹ã®å¤¢': 'ã‚°ãƒ©ã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’æ„è­˜ã—ã€å®‰å®šã—ãŸåŸºç›¤ã‚’ç¯‰ãã“ã¨ã«æ³¨åŠ›ã—ã¦ãã ã•ã„ã€‚',
                'æ—¥å¸¸çš„ãªå¤¢': 'ç¾åœ¨ã®ç”Ÿæ´»ãƒªã‚ºãƒ ã‚’ç¶­æŒã—ã€å°ã•ãªå¹¸ã›ã‚’å¤§åˆ‡ã«ã—ã¦ãã ã•ã„ã€‚'
            };
            
            return advices[dreamType] || advices['æ—¥å¸¸çš„ãªå¤¢'];
        }
        
        function displayAnalysis(analysis) {
            let html = `
                <div class="analysis-result">
                    <h3>ğŸ­ å¤¢ã®ã‚¿ã‚¤ãƒ—: ${analysis.dreamType}</h3>
                    <p>${analysis.interpretation}</p>
                </div>
                
                <div class="mood-indicator">
                    <div class="mood-item">
                        <span class="mood-emoji">ğŸ˜Š</span>
                        <div class="mood-label">ãƒã‚¸ãƒ†ã‚£ãƒ–</div>
                        <div class="mood-value">${analysis.mood.positive}</div>
                    </div>
                    <div class="mood-item">
                        <span class="mood-emoji">ğŸ˜</span>
                        <div class="mood-label">ä¸­æ€§</div>
                        <div class="mood-value">${analysis.mood.neutral}</div>
                    </div>
                    <div class="mood-item">
                        <span class="mood-emoji">ğŸ˜°</span>
                        <div class="mood-label">ãƒã‚¬ãƒ†ã‚£ãƒ–</div>
                        <div class="mood-value">${analysis.mood.negative}</div>
                    </div>
                </div>
            `;
            
            if (analysis.symbols.length > 0) {
                html += '<h3>ğŸ”® æ¤œå‡ºã•ã‚ŒãŸã‚·ãƒ³ãƒœãƒ«</h3><div class="symbol-grid">';
                analysis.symbols.forEach(symbol => {
                    html += `
                        <div class="symbol-card">
                            <span class="symbol-emoji">${symbol.emoji}</span>
                            <div class="symbol-name">${symbol.name}</div>
                            <div class="symbol-meaning">${symbol.meaning}</div>
                        </div>
                    `;
                });
                html += '</div>';
            }
            
            if (analysis.keywords.length > 0) {
                html += '<h3>ğŸ” ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</h3><div class="keywords">';
                analysis.keywords.forEach(keyword => {
                    html += `<span class="keyword">${keyword}</span>`;
                });
                html += '</div>';
            }
            
            html += `
                <div class="analysis-result">
                    <h3>ğŸ’¡ ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h3>
                    <p>${analysis.advice}</p>
                </div>
            `;
            
            document.getElementById('analysisResult').innerHTML = html;
        }
        
        function saveDream() {
            const dreamText = document.getElementById('dreamText').value.trim();
            
            if (!dreamText) {
                alert('ä¿å­˜ã™ã‚‹å¤¢ã®å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            const dream = {
                id: Date.now(),
                date: new Date().toLocaleDateString('ja-JP'),
                time: new Date().toLocaleTimeString('ja-JP'),
                content: dreamText,
                analysis: null
            };
            
            dreamHistory.unshift(dream);
            localStorage.setItem('dreamHistory', JSON.stringify(dreamHistory));
            
            updateHistoryDisplay();
            updateStats();
            
            alert('å¤¢ãŒä¿å­˜ã•ã‚Œã¾ã—ãŸï¼');
        }
        
        function clearInput() {
            document.getElementById('dreamText').value = '';
            document.getElementById('analysisResult').innerHTML = `
                <div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.6);">
                    <span style="font-size: 3rem;">ğŸŒ™</span>
                    <p>å¤¢ã®å†…å®¹ã‚’å…¥åŠ›ã—ã¦åˆ†æãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„</p>
                </div>
            `;
        }
        
        function updateHistoryDisplay() {
            const historyList = document.getElementById('dreamHistoryList');
            
            if (dreamHistory.length === 0) {
                historyList.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: rgba(255,255,255,0.6);">
                        ã¾ã å¤¢ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚æœ€åˆã®å¤¢ã‚’è¨˜éŒ²ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼
                    </div>
                `;
                return;
            }
            
            let html = '';
            dreamHistory.slice(0, 10).forEach(dream => {
                const preview = dream.content.length > 100 
                    ? dream.content.substring(0, 100) + '...'
                    : dream.content;
                
                html += `
                    <div class="history-item" onclick="loadDream(${dream.id})">
                        <div class="history-date">${dream.date} ${dream.time}</div>
                        <div class="history-preview">${preview}</div>
                    </div>
                `;
            });
            
            historyList.innerHTML = html;
        }
        
        function loadDream(dreamId) {
            const dream = dreamHistory.find(d => d.id === dreamId);
            if (dream) {
                document.getElementById('dreamText').value = dream.content;
                if (dream.analysis) {
                    displayAnalysis(dream.analysis);
                }
            }
        }
        
        function updateStats() {
            document.getElementById('totalDreams').textContent = dreamHistory.length;
            
            if (dreamHistory.length > 0) {
                // å¹³å‡æ–‡å­—æ•°è¨ˆç®—
                const avgLength = Math.round(
                    dreamHistory.reduce((sum, dream) => sum + dream.content.length, 0) / dreamHistory.length
                );
                document.getElementById('avgLength').textContent = avgLength;
                
                // ä¸€èˆ¬çš„ãªæ°—åˆ†ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã§è¨­å®šï¼‰
                const moods = ['ğŸ˜´', 'ğŸ˜Š', 'ğŸ˜°', 'ğŸ¤”', 'ğŸ˜Œ'];
                document.getElementById('commonMood').textContent = moods[Math.floor(Math.random() * moods.length)];
                
                // é€£ç¶šè¨˜éŒ²æ—¥æ•°ï¼ˆç°¡æ˜“è¨ˆç®—ï¼‰
                document.getElementById('streakDays').textContent = Math.min(dreamHistory.length, 30);
            }
        }
        
        // åˆæœŸåŒ–
        updateHistoryDisplay();
        updateStats();
        
        // ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã§ã®é€ä¿¡é˜²æ­¢
        document.getElementById('dreamText').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && e.ctrlKey) {
                analyzeDream();
            }
        });
    </script>
</body>
</html> 